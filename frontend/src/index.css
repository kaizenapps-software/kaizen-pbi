@tailwind base;
@tailwind components;
@tailwind utilities;

/* =====================  Tokens ===================== */
:root{
  --color-primary:#E53935;
  --color-primary-hover:#C62828;

  --color-background:#f7f7f8;
  --color-foreground:#0B0B0D;
  --color-panel:#ffffff;
  --color-muted:#6b7280;
  --color-border:#e5e7eb;

  --shadow-soft:0 10px 24px rgba(0,0,0,.18);
  --shadow-strong:0 24px 44px rgba(0,0,0,.28);
}
.dark{
  --color-background:#0f1115;
  --color-foreground:#E5E7EB;
  --color-panel:#121216;
  --color-muted:#9CA3AF;
  --color-border:#1F2937;
}

/* =====================  Base ===================== */
@layer base{
  html,body,#root{ height:100%; }
  body{
    background: var(--color-background);
    color: var(--color-foreground);
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji";
  }
}

/* ===================== Utilities (comunes) ===================== */
@layer utilities{
  .text-foreground{ color: var(--color-foreground); }
  .text-muted{ color: var(--color-muted); }

  .anim-page{ animation: pageIn .45s cubic-bezier(.16,1,.3,1) both; }
  @keyframes pageIn{
    from{ opacity:0; transform: translateY(10px) scale(.995) }
    to  { opacity:1; transform:none }
  }

  .has-sheen{ position:relative; overflow:hidden; }
  .has-sheen::after{
    content:""; position:absolute; inset:-200% -50% auto -50%;
    transform: rotate(12deg);
    background: linear-gradient(90deg, transparent, rgba(255,255,255,.18), transparent);
    opacity:0; transition: opacity .25s ease, transform .8s ease;
    pointer-events:none;
  }
  .has-sheen:hover::after{ opacity:.85; transform: rotate(12deg) translateX(60%); }

  .pressable{ transition: transform .08s ease; }
  .pressable:active{ transform: scale(.98); }

  .theme-anim, .theme-anim *{
    transition: background-color .25s ease, color .25s ease,
                border-color .25s ease, fill .25s ease, stroke .25s ease !important;
  }
}

/* ================================================================
   APP / DASHBOARD — aislado en .page-app
   ================================================================ */
@layer components{
  .page-app .sidebar{
    width: 240px; flex-shrink:0;
    border-right: 1px solid var(--color-border);
    background: var(--color-panel);
    position: sticky; top:0; height:100vh; z-index:40;
  }
  .page-app .sidebar-brand{ display:flex; align-items:center; gap:.75rem; padding:.9rem 1rem; }

  .page-app .nav-item{
    position:relative; isolation:isolate;
    display:flex; align-items:center; gap:.75rem;
    margin:.25rem .75rem; padding:.65rem .75rem;
    border-radius:14px;
    font-size:.9375rem;
    color:var(--color-foreground);
    transition: color .18s ease, transform .18s ease, box-shadow .18s ease;
  }
  .page-app .nav-item::before{
    content:""; position:absolute; inset:0; border-radius:inherit; z-index:0;
    background: linear-gradient(
      90deg,
      rgba(229,57,53,0) 0%,
      rgba(255,94,94,.30) 18%,
      rgba(229,57,53,.70) 55%,
      rgba(229,57,53,0) 100%
    );
    transform-origin:left center; transform:scaleX(0);
    opacity:0; pointer-events:none;
    transition: transform .35s cubic-bezier(.22,1,.36,1), opacity .25s ease;
  }
  .page-app .nav-item:hover::before{ transform:scaleX(1); opacity:1; }
  .page-app .nav-item:hover{ transform: translateY(-1px); box-shadow: var(--shadow-soft); }

  .page-app .nav-icon{ width:20px; height:20px; flex:0 0 20px; display:inline-grid; place-items:center; z-index:1; }
  .page-app .nav-item span{ position:relative; z-index:1; }

  .page-app .nav-active{ background: rgba(0,0,0,.06); }
  .dark .page-app .nav-active{ background: rgba(255,255,255,.06); }
  .page-app .nav-active::before{ opacity:0 !important; transform:none !important; }
  .page-app .nav-active::after{
    content:""; position:absolute; left:-2px; top:8px; bottom:8px; width:3px;
    border-radius:999px; background: var(--color-primary);
    box-shadow: 0 8px 24px rgba(229,57,53,.35);
  }

  /* Botones de la App */
  .page-app .btn{
    display:inline-flex; align-items:center; gap:.5rem;
    padding:.55rem 1rem; border-radius:999px;
    border:1px solid var(--color-border);
    color:#fff;
    background: linear-gradient(180deg, var(--color-primary), var(--color-primary-hover));
    box-shadow: var(--shadow-soft);
    transition: filter .15s ease, transform .15s ease;
  }
  .page-app .btn:hover{ filter:brightness(1.03); transform: translateY(-1px); }

  .page-app .btn-avatar{
    width:40px; height:40px; border-radius:999px;
    display:grid; place-items:center;
    border:1px solid var(--color-border);
    background: var(--color-panel);
  }

  .page-app .user-menu{
    min-width:260px; padding:8px;
    border:1px solid var(--color-border); border-radius:14px;
    background: var(--color-panel); box-shadow: var(--shadow-strong);
    animation: menuPop .16s ease both;
  }
  @keyframes menuPop{ from{opacity:0; transform: translateY(-6px) scale(.98)} to{opacity:1; transform:none} }
  .page-app .user-menu a{
    display:flex; align-items:center; gap:.625rem;
    min-height:44px; padding:.6rem .75rem;
    border-radius:10px; line-height:1.1;
    color:var(--color-foreground); text-decoration:none;
    transition: background-color .18s ease, transform .08s ease;
  }
  .page-app .user-menu a:hover{ background: rgba(0,0,0,.06); }
  .dark .page-app .user-menu a:hover{ background: rgba(255,255,255,.06); }
  .page-app .user-menu a:active{ transform: scale(.985); }
  .page-app .user-menu .ico{ width:20px; height:20px; flex:0 0 20px; display:inline-grid; place-items:center; }

  .page-app .btn-theme{ position:relative; overflow:hidden; }
  .page-app .btn-theme::after{
    content:""; position:absolute; inset:0; border-radius:inherit;
    box-shadow:0 0 0 0 rgba(229,57,53,0); opacity:0;
    transition: box-shadow .35s ease, opacity .35s ease;
  }
  .page-app .btn-theme.pulse::after{ box-shadow:0 0 0 14px rgba(229,57,53,.16); opacity:1; }

  .page-app .icon-theme{ position:relative; width:18px; height:18px; }
  .page-app .icon-theme svg{
    position:absolute; inset:0;
    transition: transform .35s cubic-bezier(.22,1,.36,1), opacity .25s ease;
  }
  .page-app .icon-theme .sun{ opacity:1; transform: rotate(0) scale(1); }
  .page-app .icon-theme .moon{ opacity:0; transform: rotate(-90deg) scale(.6); }
  .dark .page-app .icon-theme .sun{ opacity:0; transform: rotate(90deg) scale(.6); }
  .dark .page-app .icon-theme .moon{ opacity:1; transform: rotate(0) scale(1); }
}

/* ================================================================
   LOGIN 
   ================================================================ */
@layer components{
.page-login.login-bg,
.page-login .login-bg{
  position: relative;
  background:
    radial-gradient(1200px 600px at -10% -10%, rgba(229,57,53,.16), transparent 60%),
    radial-gradient(1000px 520px at 120% 120%, rgba(229,57,53,.10), transparent 62%),
    var(--wall) center/cover no-repeat,
    var(--color-background);
}

.page-login .login-vignette{
  position:absolute; inset:0; pointer-events:none;
  background: linear-gradient(180deg, rgba(0,0,0,.22), rgba(0,0,0,.16));
}

  /* Tarjeta de autenticación */
  .page-login .auth-card{
    border: 1px solid var(--color-border);
    background: linear-gradient(180deg, var(--color-panel), color-mix(in oklab, var(--color-panel) 86%, #000 14%));
    border-radius: 18px;
    padding: 22px;
    box-shadow: 0 20px 40px rgba(0,0,0,.22);
  }

  /* Campos */
  .page-login .label{ display:block; font-size: 12px; margin-bottom:.4rem; color: var(--color-muted); }
  .page-login .input-wrap{ position:relative; display:flex; align-items:center; }
  .page-login .input{
    width: 100%;
    border: 1px solid var(--color-border);
    background: var(--color-panel);
    color: var(--color-foreground);
    border-radius: 12px;
    padding: 10px 12px 10px 38px;
    outline: none;
    transition: box-shadow .15s ease, border-color .15s ease, background-color .2s ease;
  }
  .page-login .input:focus{
    border-color: color-mix(in oklab, var(--color-primary) 65%, var(--color-border));
    box-shadow: 0 0 0 4px color-mix(in oklab, var(--color-primary) 18%, transparent);
  }
  .page-login .input-wrap.has-error .input{
    border-color: #ef4444;
    box-shadow: 0 0 0 4px rgba(239,68,68,.18);
  }
  .page-login .leading-ico{ position:absolute; left:10px; color: var(--color-muted); }

  .page-login .help{ margin-top: .4rem; font-size: 12px; }
  .page-login .help.is-muted{ color: var(--color-muted); }
  .page-login .help.is-error{ color: #ef4444; }

  /* Botón primario (aislado) */
  .page-login .btn{
    @apply inline-flex items-center justify-center gap-2 rounded-2xl px-4 py-2;
    color: #fff;
    background: linear-gradient(180deg, var(--color-primary), var(--color-primary-hover));
    box-shadow: 0 14px 32px rgba(229,57,53,.35);
    transition: transform .12s ease, filter .15s ease;
  }
  .page-login .btn:hover{ transform: translateY(-1px); filter: brightness(1.03); }
  .page-login .btn.is-loading{ opacity:.85; cursor: wait; }

  /* Spinner botón */
  .page-login .spinner{
    width: 1rem; height: 1rem; border-radius: 999px;
    border: 2px solid rgba(255,255,255,.35);
    border-top-color: #fff;
    animation: spin .8s linear infinite;
  }
  @keyframes spin{ to { transform: rotate(360deg); } }

  /* Chip con logo K */
  .page-login .k-mark{
    width:44px; height:44px; border-radius: 12px; display:grid; place-items:center;
    background: linear-gradient(180deg, rgba(229,57,53,.25), rgba(229,57,53,.06));
    box-shadow: inset 0 1px 0 rgba(255,255,255,.08), 0 8px 24px rgba(0,0,0,.25);
  }

  /* Avisos OK */
  .page-login .notice{ border-radius: 12px; padding: .6rem .8rem; font-size: 14px; }
  .page-login .notice-ok{
    border: 1px solid color-mix(in oklab, var(--color-primary) 48%, var(--color-border));
    background: linear-gradient(180deg, rgba(34,197,94,.12), rgba(34,197,94,.06));
    color: #22c55e;
  }

  /* Animación de éxito */
  .page-login.login-success .auth-card{
    animation: cardOut .45s ease-in forwards;
  }
  @keyframes cardOut{
    to{ transform: scale(.96); filter: blur(6px); opacity: 0; }
  }

  .page-login .success-overlay{
    position: fixed; inset: 0; z-index: 70; pointer-events: none;
    display: grid; place-items: center;
    mix-blend-mode: normal;
  }
  .page-login .success-circle{
    width: 28px; height: 28px; border-radius: 999px;
    background:
      radial-gradient(closest-side, rgba(255,255,255,.22), transparent 70%),
      linear-gradient(180deg, var(--color-primary), var(--color-primary-hover));
    box-shadow: 0 0 0 0 rgba(229,57,53,.55);
    animation: circleExpand .8s cubic-bezier(.16,1,.3,1) forwards;
  }
  @keyframes circleExpand{
    to{ width: 200vmax; height: 200vmax; opacity: .95; }
  }
  .page-login .success-pulse{
    position: absolute; width: 18px; height: 18px; border-radius: 999px;
    box-shadow: 0 0 0 0 rgba(229,57,53,.55);
    animation: pulse .85s ease-out 2;
  }
  @keyframes pulse{
    to{ box-shadow: 0 0 0 64px rgba(229,57,53,0); }
  }

.page-login.login-success .banner{
  animation: bannerOut .45s ease-in forwards;
}

@keyframes bannerOut{
  to{
    opacity: 0;
    transform: translateY(6px) scale(.98);
    filter: blur(4px);
  }
}
}
